{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Moneykicks/Desktop/hello/TeamCode-main (1)/TeamCode-main/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Moneykicks/Desktop/hello/TeamCode-main (1)/TeamCode-main/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Moneykicks/Desktop/hello/TeamCode-main (1)/TeamCode-main/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useRef,useState}from\"react\";import Client from\"./Client\";import Editor from\"./Editor\";import{initSocket}from\"../Socket\";import{ACTIONS}from\"../Actions\";import{useNavigate,useLocation,Navigate,useParams}from\"react-router-dom\";import{toast}from\"react-hot-toast\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function EditorPage(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),clients=_useState2[0],setClients=_useState2[1];var codeRef=useRef(null);var Location=useLocation();var navigate=useNavigate();var _useParams=useParams(),roomId=_useParams.roomId;var socketRef=useRef(null);useEffect(function(){var init=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _Location$state;var handleErrors;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return initSocket();case 2:socketRef.current=_context.sent;socketRef.current.on(\"connect_error\",function(err){return handleErrors(err);});socketRef.current.on(\"connect_failed\",function(err){return handleErrors(err);});handleErrors=function handleErrors(err){console.log(\"Error\",err);toast.error(\"Socket connection failed, Try again later\");navigate(\"/\");};socketRef.current.emit(ACTIONS.JOIN,{roomId:roomId,username:(_Location$state=Location.state)===null||_Location$state===void 0?void 0:_Location$state.username});socketRef.current.on(ACTIONS.JOINED,function(_ref2){var _Location$state2;var clients=_ref2.clients,username=_ref2.username,socketId=_ref2.socketId;if(username!==((_Location$state2=Location.state)===null||_Location$state2===void 0?void 0:_Location$state2.username)){toast.success(\"\".concat(username,\" joined the room.\"));}setClients(clients);socketRef.current.emit(ACTIONS.SYNC_CODE,{code:codeRef.current,socketId:socketId});});socketRef.current.on(ACTIONS.DISCONNECTED,function(_ref3){var socketId=_ref3.socketId,username=_ref3.username;toast.success(\"\".concat(username,\" left the room\"));setClients(function(prev){return prev.filter(function(client){return client.socketId!==socketId;});});});case 9:case\"end\":return _context.stop();}},_callee);}));return function init(){return _ref.apply(this,arguments);};}();init();return function(){socketRef.current&&socketRef.current.disconnect();socketRef.current.off(ACTIONS.JOINED);socketRef.current.off(ACTIONS.DISCONNECTED);};},[]);if(!Location.state){return/*#__PURE__*/_jsx(Navigate,{to:\"/\"});}var copyRoomId=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return navigator.clipboard.writeText(roomId);case 3:toast.success(\"Room ID copied\");_context2.next=10;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);toast.error(\"Unable to copy the Room ID\");case 10:case\"end\":return _context2.stop();}},_callee2,null,[[0,6]]);}));return function copyRoomId(){return _ref4.apply(this,arguments);};}();var leaveRoom=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:navigate(\"/\");case 1:case\"end\":return _context3.stop();}},_callee3);}));return function leaveRoom(){return _ref5.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid vh-100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row h-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-2 bg-dark text-light d-flex flex-column h-100\",style:{boxShadow:\"2px 0px 4px rgba(0, 0, 0, 0.1)\"},children:[/*#__PURE__*/_jsx(\"img\",{src:\"/images/Colorful_Brain_Digital_World_Technology_Logo-removebg-preview (1).png\",alt:\"Logo\",className:\"img-fluid mx-auto\",style:{maxWidth:\"120px\",margin:\"5px auto\"}}),/*#__PURE__*/_jsx(\"hr\",{style:{marginTop:\"-12px\"}}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column flex-grow-1 overflow-auto\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"mb-2\",children:\"Members\"}),clients.map(function(client){return/*#__PURE__*/_jsx(Client,{username:client.username},client.socketId);})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-auto\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success\",onClick:copyRoomId,children:\"Copy Room ID\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger mt-2 mb-2 px-3 btn-block\",onClick:leaveRoom,children:\"Leave Room\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-10 text-light d-flex flex-column h-100\",children:/*#__PURE__*/_jsx(Editor,{socketRef:socketRef,roomId:roomId,onCodeChange:function onCodeChange(code){codeRef.current=code;}})})]})});}export default EditorPage;","map":{"version":3,"names":["React","useEffect","useRef","useState","Client","Editor","initSocket","ACTIONS","useNavigate","useLocation","Navigate","useParams","toast","jsx","_jsx","jsxs","_jsxs","EditorPage","_useState","_useState2","_slicedToArray","clients","setClients","codeRef","Location","navigate","_useParams","roomId","socketRef","init","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_Location$state","handleErrors","wrap","_callee$","_context","prev","next","current","sent","on","err","console","log","error","emit","JOIN","username","state","JOINED","_ref2","_Location$state2","socketId","success","concat","SYNC_CODE","code","DISCONNECTED","_ref3","filter","client","stop","apply","arguments","disconnect","off","to","copyRoomId","_ref4","_callee2","_callee2$","_context2","navigator","clipboard","writeText","t0","leaveRoom","_ref5","_callee3","_callee3$","_context3","className","children","style","boxShadow","src","alt","maxWidth","margin","marginTop","map","onClick","onCodeChange"],"sources":["C:/Users/Moneykicks/Desktop/hello/TeamCode-main (1)/TeamCode-main/client/src/components/EditorPage.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport Client from \"./Client\";\nimport Editor from \"./Editor\";\nimport { initSocket } from \"../Socket\";\nimport { ACTIONS } from \"../Actions\";\nimport { useNavigate, useLocation, Navigate, useParams } from \"react-router-dom\";\nimport { toast } from \"react-hot-toast\";\n\nfunction EditorPage() {\n  const [clients, setClients] = useState([]);\n  const codeRef = useRef(null);\n\n  const Location = useLocation();\n  const navigate = useNavigate();\n  const { roomId } = useParams();\n\n  const socketRef = useRef(null);\n  useEffect(() => {\n    const init = async () => {\n      socketRef.current = await initSocket();\n      socketRef.current.on(\"connect_error\", (err) => handleErrors(err));\n      socketRef.current.on(\"connect_failed\", (err) => handleErrors(err));\n\n      const handleErrors = (err) => {\n        console.log(\"Error\", err);\n        toast.error(\"Socket connection failed, Try again later\");\n        navigate(\"/\");\n      };\n\n      socketRef.current.emit(ACTIONS.JOIN, {\n        roomId,\n        username: Location.state?.username,\n      });\n\n      socketRef.current.on(\n        ACTIONS.JOINED,\n        ({ clients, username, socketId }) => {\n          if (username !== Location.state?.username) {\n            toast.success(`${username} joined the room.`);\n          }\n          setClients(clients);\n          socketRef.current.emit(ACTIONS.SYNC_CODE, {\n            code: codeRef.current,\n            socketId,\n          });\n        }\n      );\n\n      socketRef.current.on(ACTIONS.DISCONNECTED, ({ socketId, username }) => {\n        toast.success(`${username} left the room`);\n        setClients((prev) => {\n          return prev.filter((client) => client.socketId !== socketId);\n        });\n      });\n    };\n    init();\n\n    return () => {\n      socketRef.current && socketRef.current.disconnect();\n      socketRef.current.off(ACTIONS.JOINED);\n      socketRef.current.off(ACTIONS.DISCONNECTED);\n    };\n  }, []);\n\n  if (!Location.state) {\n    return <Navigate to=\"/\" />;\n  }\n\n  const copyRoomId = async () => {\n    try {\n      await navigator.clipboard.writeText(roomId);\n      toast.success(`Room ID copied`);\n    } catch (error) {\n      console.log(error);\n      toast.error(\"Unable to copy the Room ID\");\n    }\n  };\n\n  const leaveRoom = async () => {\n    navigate(\"/\");\n  };\n\n  return (\n    <div className=\"container-fluid vh-100\">\n      <div className=\"row h-100\">\n        {/* client panel */}\n        <div\n          className=\"col-md-2 bg-dark text-light d-flex flex-column h-100\"\n          style={{ boxShadow: \"2px 0px 4px rgba(0, 0, 0, 0.1)\" }}\n        >\n          <img\n            src=\"/images/Colorful_Brain_Digital_World_Technology_Logo-removebg-preview (1).png\"\n            alt=\"Logo\"\n            className=\"img-fluid mx-auto\"\n            style={{ maxWidth: \"120px\", margin: \"5px auto\" }}\n          />\n          <hr style={{ marginTop: \"-12px\" }} />\n\n          {/* Client list container */}\n          <div className=\"d-flex flex-column flex-grow-1 overflow-auto\">\n            <span className=\"mb-2\">Members</span>\n            {clients.map((client) => (\n              <Client key={client.socketId} username={client.username} />\n            ))}\n          </div>\n\n          <hr />\n          {/* Buttons */}\n          <div className=\"mt-auto\">\n            <button className=\"btn btn-success\" onClick={copyRoomId}>\n              Copy Room ID\n            </button>\n            <button\n              className=\"btn btn-danger mt-2 mb-2 px-3 btn-block\"\n              onClick={leaveRoom}\n            >\n              Leave Room\n            </button>\n          </div>\n        </div>\n\n        {/* Editor panel */}\n        <div className=\"col-md-10 text-light d-flex flex-column h-100\">\n          <Editor\n            socketRef={socketRef}\n            roomId={roomId}\n            onCodeChange={(code) => {\n              codeRef.current = code;\n            }}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default EditorPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}